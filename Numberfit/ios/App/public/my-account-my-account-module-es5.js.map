{"version":3,"sources":["src/app/my-account/my-account.page.html","src/app/my-account/my-account-routing.module.ts","src/app/my-account/my-account.module.ts","src/app/my-account/my-account.page.scss","src/app/my-account/my-account.page.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<ion-header>\\n  <meta charset=\\\"UTF-8\\\">\\n  <ion-toolbar>\\n    <ion-title><img class=\\\"header-image\\\" src=\\\"/assets/NumberfitLogo.png\\\"/></ion-title>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"ion-content\\\" fullscreen>\\n<ion-card>\\n  <ion-card-header>\\n    <ion-title class=\\\"welcome-card-title\\\">My Account</ion-title>\\n  </ion-card-header>\\n  <ion-card-content>\\n    <form [formGroup]=\\\"modifyDetailsFormGroup\\\">\\n    <ion-item style=\\\"margin-top: 20px;\\\">\\n      <ion-label>Name</ion-label>\\n      <ion-input value={{name}} readonly style=\\\"text-align: right;\\\"></ion-input>\\n    </ion-item>\\n    <ion-item>\\n      <ion-label>Email</ion-label>\\n      <ion-input value={{email}} readonly type=\\\"email\\\" style=\\\"text-align: right;\\\"></ion-input>\\n    </ion-item>\\n    <ion-item>\\n      <ion-label>Year Group</ion-label>\\n      <ion-select\\n            formControlName=\\\"year\\\" multiple=\\\"false\\\"\\n            cancelText=\\\"Cancel\\\" okText=\\\"Select\\\">\\n            <ion-select-option *ngFor=\\\"let year of yearGroups\\\" value={{year}}>\\n              {{year}}\\n            </ion-select-option>\\n          </ion-select>\\n    </ion-item>\\n    <ion-item>\\n      <ion-label>School</ion-label>\\n      <ion-select\\n            formControlName=\\\"school\\\" id=\\\"schoolSelect\\\"\\n            multiple=\\\"false\\\" cancelText=\\\"Cancel\\\" okText=\\\"Select\\\">\\n            <ion-select-option *ngFor=\\\"let school of schoolList\\\" value={{school}}>\\n              {{school}}\\n            </ion-select-option>\\n          </ion-select>\\n    </ion-item>\\n    <ion-item>\\n      <ion-label position=\\\"floating\\\">Change Password</ion-label>\\n      <ion-input formControlName=\\\"password1\\\" type='password'></ion-input>\\n    </ion-item>\\n    <ion-item>\\n      <ion-label position=\\\"floating\\\">Comfirm Password</ion-label>\\n      <ion-input formControlName=\\\"password2\\\" type='password'></ion-input>\\n    </ion-item>\\n    <br>\\n    <ion-button\\n          (click)=\\\"modifyDetails()\\\"\\n          expand='block'>\\n          Confirm Changes\\n    </ion-button>\\n    </form>\\n  </ion-card-content>\\n</ion-card>\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MyAccountPage } from './my-account.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MyAccountPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class MyAccountPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MyAccountPageRoutingModule } from './my-account-routing.module';\n\nimport { MyAccountPage } from './my-account.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ReactiveFormsModule,\n    MyAccountPageRoutingModule\n  ],\n  declarations: [MyAccountPage]\n})\nexport class MyAccountPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL215LWFjY291bnQvbXktYWNjb3VudC5wYWdlLnNjc3MifQ== */\"","import { FormGroup, FormBuilder, Validators, ControlContainer } from '@angular/forms';\nimport { Component, OnInit }      from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { Md5 }                    from 'ts-md5/dist/md5';\nimport { NativeStorage }          from '@ionic-native/native-storage/ngx';\n\n@Component({\n  selector    : 'app-my-account',\n  templateUrl : './my-account.page.html',\n  styleUrls   : ['./my-account.page.scss'],\n})\nexport class MyAccountPage implements OnInit {\n\n  server     : string;\n  cookie     : string;\n  userObj    : any;\n  modifyDetailsFormGroup: FormGroup;\n  // formBuilder: FormBuilder;\n  yearGroups : Array<string>;\n  schoolList : Array<string>;\n  name       : string;\n  email      : string;\n\n  constructor(\n    private nativeStorage : NativeStorage,\n    private router        : Router,\n    private route         : ActivatedRoute,\n    private formBuilder   : FormBuilder\n  ) {\n    // Get server from config file\n    this.server = require('../config.json').server;\n    // Get cookie from storage\n    this.nativeStorage.getItem('cookie')\n    .then((data) => {this.cookie = data.cookie});\n\n    this.yearGroups = ['Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5', 'Year 6'];\n    this.schoolList = ['UCL', 'LSE', 'Imperial'];\n    this.name       = \"Loading..\";\n    this.email      = \"Loading..\";\n    this.modifyDetailsFormGroup = formBuilder.group({\n      // name: [\"\", [Validators.required]],\n      // email: [\"\", [Validators.required, Validators.email]],\n      password1 : [\"\", [Validators.required]],\n      password2 : [\"\", [Validators.required]],\n      year      : [\"\", [Validators.required]],\n      school    : [\"\", [Validators.required]],\n    });\n  }\n\n  getUserDetails(){\n    var xhttpDetails = new XMLHttpRequest();\n    let DOM = this;\n\n    xhttpDetails.onreadystatechange = function() {\n      if (this.readyState == 4 && this.status == 200) {\n        console.log(\"GET details request succeeded\");\n        DOM.userObj = JSON.parse(this.responseText);\n        DOM.changeToLoadedData();\n      } else if(this.status != 200) {\n        console.log(\"GET request failed with status \" + this.status);\n      }\n    };\n\n    // Define and send the GET request\n    xhttpDetails.open(\"GET\", this.server+\"/myDetails?cookie=\"+this.cookie, true);\n    xhttpDetails.send();\n  }\n\n  modifyDetails(){\n    const DOM = this;\n\n    const password1 = this.modifyDetailsFormGroup.value.password1;\n    const password2 = this.modifyDetailsFormGroup.value.password2;\n\n    const credentials = {\n      // username : this.modifyDetailsFormGroup.value.email.toLowerCase(),\n      password : Md5.hashStr(password1),\n      // name     : this.modifyDetailsFormGroup.value.name,\n      year     : this.modifyDetailsFormGroup.value.year,\n      school   : this.modifyDetailsFormGroup.value.school\n    };\n\n    if(password1==password2 && password1.length > 7){\n      var xhttp = new XMLHttpRequest();\n\n      xhttp.onreadystatechange = function() {\n        if (this.readyState == 4 && this.status == 200) {\n          const cookie = JSON.parse(this.responseText);\n          console.log(cookie);\n        } else if(this.status != 200) {\n          console.log(this.responseText);\n\n        }\n      };\n      console.log(credentials);\n      xhttp.open('POST', this.server+'/modifyDetails', true);\n      xhttp.setRequestHeader(\"Content-type\", \"application/json\");\n      xhttp.send(JSON.stringify(credentials));\n\n    } else{\n      // error!!!\n      alert(\"Please ensure your password is at least 8 characters and matches the confirmation field\");\n    }\n\n  }\n\n  changeToLoadedData(){\n    this.modifyDetailsFormGroup.reset({school: this.userObj.school, year: \"Year \" + this.userObj.year});\n    this.name  = this.userObj.name;\n    this.email = this.userObj.username;\n  }\n\n  ngOnInit() {\n    // this.cookie = this.route.snapshot.paramMap.get('cookie');\n    // console.log(this.cookie);\n    this.getUserDetails();\n    // this.modifyDetailsFormGroup.reset({name: this.userObj.name});\n    // this.modifyDetailsFormGroup.get('name').setValue(this.userObj.name);\n  }\n\n}\n"],"sourceRoot":"webpack:///","file":"my-account-my-account-module-es5.js"}