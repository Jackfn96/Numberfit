{"version":3,"sources":["./src/app/my-account/my-account.page.html","./src/app/my-account/my-account-routing.module.ts","./src/app/my-account/my-account.module.ts","./src/app/my-account/my-account.page.scss","./src/app/my-account/my-account.page.ts"],"names":[],"mappings":"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","file":"my-account-my-account-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <meta charset=\\\"UTF-8\\\">\\n  <ion-toolbar>\\n    <ion-title><img class=\\\"header-image\\\" src=\\\"/assets/NumberfitLogo.png\\\"/></ion-title>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"ion-content\\\" fullscreen>\\n<ion-card>\\n  <ion-card-header>\\n    <ion-title class=\\\"welcome-card-title\\\">My Account</ion-title>\\n  </ion-card-header>\\n  <ion-card-content>\\n    <form [formGroup]=\\\"modifyDetailsFormGroup\\\">\\n    <ion-item style=\\\"margin-top: 20px;\\\">\\n      <ion-label>Name</ion-label>\\n      <ion-input value={{name}} readonly style=\\\"text-align: right;\\\"></ion-input>\\n    </ion-item>\\n    <ion-item>\\n      <ion-label>Email</ion-label>\\n      <ion-input value={{email}} readonly type=\\\"email\\\" style=\\\"text-align: right;\\\"></ion-input>\\n    </ion-item>\\n    <ion-item>\\n      <ion-label>Year Group</ion-label>\\n      <ion-select\\n            formControlName=\\\"year\\\" multiple=\\\"false\\\"\\n            cancelText=\\\"Cancel\\\" okText=\\\"Select\\\">\\n            <ion-select-option *ngFor=\\\"let year of yearGroups\\\" value={{year}}>\\n              {{year}}\\n            </ion-select-option>\\n          </ion-select>\\n    </ion-item>\\n    <ion-item>\\n      <ion-label>School</ion-label>\\n      <ion-select\\n            formControlName=\\\"school\\\" id=\\\"schoolSelect\\\"\\n            multiple=\\\"false\\\" cancelText=\\\"Cancel\\\" okText=\\\"Select\\\">\\n            <ion-select-option *ngFor=\\\"let school of schoolList\\\" value={{school}}>\\n              {{school}}\\n            </ion-select-option>\\n          </ion-select>\\n    </ion-item>\\n    <ion-item>\\n      <ion-label position=\\\"floating\\\">Change Password</ion-label>\\n      <ion-input formControlName=\\\"password1\\\" type='password'></ion-input>\\n    </ion-item>\\n    <ion-item>\\n      <ion-label position=\\\"floating\\\">Comfirm Password</ion-label>\\n      <ion-input formControlName=\\\"password2\\\" type='password'></ion-input>\\n    </ion-item>\\n    <br>\\n    <ion-button\\n          (click)=\\\"modifyDetails()\\\"\\n          expand='block'>\\n          Confirm Changes\\n    </ion-button>\\n    </form>\\n  </ion-card-content>\\n</ion-card>\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MyAccountPage } from './my-account.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MyAccountPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class MyAccountPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MyAccountPageRoutingModule } from './my-account-routing.module';\n\nimport { MyAccountPage } from './my-account.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ReactiveFormsModule,\n    MyAccountPageRoutingModule\n  ],\n  declarations: [MyAccountPage]\n})\nexport class MyAccountPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL215LWFjY291bnQvbXktYWNjb3VudC5wYWdlLnNjc3MifQ== */\"","import { FormGroup, FormBuilder, Validators, ControlContainer } from '@angular/forms';\nimport { Component, OnInit }      from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { NativeStorage }          from '@ionic-native/native-storage/ngx';\nimport { HTTP }                   from '@ionic-native/http/ngx';\nimport { Md5 }                    from 'ts-md5/dist/md5';\n\n@Component({\n  selector    : 'app-my-account',\n  templateUrl : './my-account.page.html',\n  styleUrls   : ['./my-account.page.scss'],\n})\nexport class MyAccountPage implements OnInit {\n\n  server     : string = require('../config.json').server;\n  cookie     : string;\n  userObj    : any;\n  modifyDetailsFormGroup: FormGroup;\n  // formBuilder: FormBuilder;\n  yearGroups : Array<string>;\n  schoolList : Array<string>;\n  name       : string = \"Loading..\";\n  email      : string = \"Loading..\";\n\n  constructor(\n    private nativeStorage : NativeStorage,\n    private router        : Router,\n    private http          : HTTP,\n    private route         : ActivatedRoute,\n    private formBuilder   : FormBuilder,\n  ) {\n    // Get cookie from storage\n    this.nativeStorage.getItem('cookie')\n    .then((data) => {this.cookie = data.cookie});\n    // Get user from storage\n    this.nativeStorage.getItem('user')\n    .then((data) => {this.userObj = data});\n\n    this.yearGroups = ['Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5', 'Year 6'];\n    this.schoolList = ['UCL', 'LSE', 'Imperial'];\n    this.modifyDetailsFormGroup = formBuilder.group({\n      // name: [\"\", [Validators.required]],\n      // email: [\"\", [Validators.required, Validators.email]],\n      password1 : [\"\", [Validators.required]],\n      password2 : [\"\", [Validators.required]],\n      year      : [\"\", [Validators.required]],\n      school    : [\"\", [Validators.required]],\n    });\n  }\n\n  // getUserDetails(){\n  //   var xhttpDetails = new XMLHttpRequest();\n  //   let DOM = this;\n  //\n  //   xhttpDetails.onreadystatechange = function() {\n  //     if (this.readyState == 4 && this.status == 200) {\n  //       console.log(\"GET details request succeeded\");\n  //       DOM.userObj = JSON.parse(this.responseText);\n  //       DOM.changeToLoadedData();\n  //     } else if(this.status != 200) {\n  //       console.log(\"GET request failed with status \" + this.status);\n  //     }\n  //   };\n  //\n  //   // Define and send the GET request\n  //   xhttpDetails.open(\"GET\", this.server+\"/myDetails?cookie=\"+this.cookie, true);\n  //   xhttpDetails.send();\n  // }\n\n  modifyDetails(){\n\n    const password1 = this.modifyDetailsFormGroup.value.password1;\n    const password2 = this.modifyDetailsFormGroup.value.password2;\n\n    const credentials = {\n      // username : this.modifyDetailsFormGroup.value.email.toLowerCase(),\n      password : Md5.hashStr(password1),\n      // name     : this.modifyDetailsFormGroup.value.name,\n      year     : this.modifyDetailsFormGroup.value.year,\n      school   : this.modifyDetailsFormGroup.value.school\n    };\n\n    if(password1==password2 && password1.length > 7){\n\n      this.http.post(this.server + \"/modifyDetails\", credentials, {})\n      .then(data => {\n        // var user = JSON.parse(data.data);\n        // var user = data.data;\n        // console.log(\"user: \", user)\n        // console.log(\"response: \", data)\n        // this.nativeStorage.setItem('cookie', {cookie: user.cookie})\n        // .then(() => {\n        //   this.nativeStorage.setItem('user', {\n        //     username : user.username,\n        //     name     : user.name,\n        //     school   : user.school,\n        //     year     : user.year,\n        //     teacher  : user.teacher,\n        //   })\n        //   .then(() => {\n        //     // console.log(\"got to play\")\n        //     this.router.navigate(['/play'])\n        //   }, error => console.error('Error storing user', error));\n        // }, error => console.error('Error storing cookie', error));\n\n      })\n      .catch(error => {\n        console.log(\"error here\",error.error)\n        this.presentAlert();\n\n      });\n\n      // var xhttp = new XMLHttpRequest();\n      //\n      // xhttp.onreadystatechange = function() {\n      //   if (this.readyState == 4 && this.status == 200) {\n      //     const cookie = JSON.parse(this.responseText);\n      //     console.log(cookie);\n      //   } else if(this.status != 200) {\n      //     console.log(this.responseText);\n      //\n      //   }\n      // };\n      // console.log(credentials);\n      // xhttp.open('POST', this.server+'/modifyDetails', true);\n      // xhttp.setRequestHeader(\"Content-type\", \"application/json\");\n      // xhttp.send(JSON.stringify(credentials));\n\n    } else{\n      // error!!!\n      alert(\"Please ensure your password is at least 8 characters and matches the confirmation field\");\n    }\n\n  }\n\n  changeToLoadedData(){\n    this.modifyDetailsFormGroup.reset({school: this.userObj.school, year: \"Year \" + this.userObj.year});\n    this.name  = this.userObj.name;\n    this.email = this.userObj.username;\n  }\n\n  ngOnInit() {\n    // this.cookie = this.route.snapshot.paramMap.get('cookie');\n    // console.log(this.cookie);\n    // this.getUserDetails();\n    // this.modifyDetailsFormGroup.reset({name: this.userObj.name});\n    // this.modifyDetailsFormGroup.get('name').setValue(this.userObj.name);\n  }\n\n  presentAlert() {\n    const alert = document.createElement('ion-alert');\n    alert.header = 'Error';\n    alert.message = 'Please check your internet connection.';\n    alert.buttons = ['OK'];\n\n    document.body.appendChild(alert);\n    return alert.present();\n  }\n\n}\n"],"sourceRoot":"webpack:///"}